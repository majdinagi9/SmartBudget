<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Finance Tracker</title>
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
    <div class="container mt-5">
        <h1 class="text-center mb-4">Personal Finance Tracker</h1>

        <!-- Google OAuth Login Button -->
        <div id="login-section" class="d-grid gap-2 mt-4 text-center">
            <div id="g_id_onload"
                 data-client_id="188567386797-2nrkk1rohdh1ibvdb67kj4q7oiqv18d9.apps.googleusercontent.com"
                 data-login_uri="http://localhost:3000"
                 data-callback="onSignIn">
            </div>
            <div class="g_id_signin"
                 data-type="standard"
                 data-shape="rectangular"
                 data-theme="outline"
                 data-text="sign_in_with"
                 data-size="large">
            </div>
        </div>

        <!-- User Info & Finance Tracker -->
        <div id="user-info" class="mt-5 text-center" style="display: none;"></div>

        <!-- Finance Tracker Section -->
        <div id="tracker-section" style="display: none;">
            <div class="input-section mb-4">
                <div class="row g-2">
                    <div class="col-12 col-md-6">
                        <input type="text" id="description" class="form-control" placeholder="Description">
                    </div>
                    <div class="col-12 col-md-6">
                        <input type="number" id="amount" class="form-control" placeholder="Amount">
                    </div>
                </div>
                <div class="d-grid gap-2 mt-2">
                    <button id="add-transaction" class="btn btn-success">Add Transaction</button>
                    <button id="save-transaction" class="btn btn-primary" style="display: none;">Save Changes</button>
                </div>
            </div>

            <div class="balance-section text-center mb-4">
                <h2>Balance</h2>
                <div id="balance" class="fs-2 fw-bold">$0.00</div>
            </div>

            <button id="toggle-history" class="btn btn-info w-100 mb-4">Show Transaction History</button>

            <div class="history-section" id="history-section" style="display: none;">
                <h2 class="mb-3">Transaction History</h2>
                <ul id="history-list" class="list-group"></ul>
            </div>

            <button id="clear-data" class="btn btn-danger w-100">Clear All Data</button>
        </div>
    </div>

    <!-- Google OAuth SDK -->
    <script src="https://accounts.google.com/gsi/client" async defer></script>

    <!-- Google OAuth Sign-In Callback -->
    <script>
        function onSignIn(response) {
            const userData = response.credential;
            const decodedToken = jwt_decode(userData);

            // Hide the Google login button after sign-in
            document.getElementById('login-section').style.display = 'none';

            // Show the user info and finance tracker
            displayUserInfo(decodedToken);
        }

        // Display User Info and Finance Tracker
        function displayUserInfo(user) {
            const userInfoDiv = document.getElementById('user-info');
            userInfoDiv.innerHTML = `
                <h3>Welcome, ${user.name}!</h3>
                <p>Email: ${user.email}</p>
                <img src="${user.picture}" alt="Profile Picture" class="img-fluid rounded-circle" width="100">
            `;
            userInfoDiv.style.display = 'block';
            document.getElementById('tracker-section').style.display = 'block';
        }
    </script>

    <!-- JWT Decode Library -->
    <script src="https://cdn.jsdelivr.net/npm/jwt-decode/build/jwt-decode.min.js"></script>

    <!-- Bootstrap JS and dependencies -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
    <script src="app.js"></script>
</body>
</html>
